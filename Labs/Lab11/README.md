# Лабораторная работа №11 BGP. Фильтрация

#### Цель: 

Настроить фильтрацию для офиса Москва.
Настроить фильтрацию для офиса С.-Петербург.

## Топология

Выполнение лабораторной работы будет происходить на созданном при выполнении лабораторной работы №4 стенде:

![](lab11.PNG)

## Ход работы

Лабораторная работа разбита на 4 части:
1) Настройка фильтрации в офисе Москва так, чтобы не появилось транзитного трафика(As-path)
2) Настройка фильтрации в офисе С.-Петербург так, чтобы не появилось транзитного трафика(Prefix-list)
3) Настройка провайдера Киторн так, чтобы в офис Москва отдавался только маршрут по умолчанию
4) Настройка провайдера Ламас так, чтобы в офис Москва отдавался только маршрут по умолчанию и префикс офиса С.-Петербург

При этом все внешние сети в лабораторной работе должны иметь IP связность.

## Часть 1. Настройка фильтрации в офисе Москва так, чтобы не появилось транзитного трафика(As-path)

На маршрутизаторах R14 и R15 необходимо создать и назначить на интерфейс в сторону провайдера as-path фильтр разрешающий отправку update сообщений только о своих внутренних подсетях. 

В выводе running-config маршрутизаторов появятся настройки:

#### Маршрутизатор R14:

```

```

#### Маршрутизатор R15:

```

```

## Часть 2. Настройка фильтрации в офисе С.-Петербург так, чтобы не появилось транзитного трафика(Prefix-list)

Необходимо включить на маршрутизаторе R14 iBGP соседа R15, на маршрутизаторе R15 iBGP соседа R14. Настроить на R14 и R15 loopback интерфейсы и включить на них ospf,  настроить update-source на Loopback интерфейс для iBGP соседа и настроить next-hop-self.

В выводе running-config маршрутизаторов появятся настройки:

#### Маршрутизатор R18:

```

```

## Часть 3. Настройка провайдера Киторн так, чтобы в офис Москва отдавался только маршрут по умолчанию

Необходимо включить на маршрутизаторе R14 iBGP соседа R15, на маршрутизаторе R15 iBGP соседа R14. Настроить на R14 и R15 loopback интерфейсы и включить на них ospf,  настроить update-source на Loopback интерфейс для iBGP соседа и настроить next-hop-self.

В выводе running-config маршрутизаторов появятся настройки:

#### Маршрутизатор R22:

```

```

## Часть 3. Настройка провайдера Ламас так, чтобы в офис Москва отдавался только маршрут по умолчанию и префикс офиса С.-Петербург

Необходимо включить на маршрутизаторе R14 iBGP соседа R15, на маршрутизаторе R15 iBGP соседа R14. Настроить на R14 и R15 loopback интерфейсы и включить на них ospf,  настроить update-source на Loopback интерфейс для iBGP соседа и настроить next-hop-self.

В выводе running-config маршрутизаторов появятся настройки:

#### Маршрутизатор R21:

```

```
